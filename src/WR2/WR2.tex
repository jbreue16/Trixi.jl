



\documentclass[11pt]{scrartcl}

%-------------------------------------------------------------------------------------------
% Präambel
%-------------------------------------------------------------------------------------------

% Pakete zur Verwendung der europäischen Schriftarten sowie der deutschen Sprache
\usepackage[ngerman]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}


% Pakete zur Vewendung mathematischer Umgebungen und Symbole
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}

% Paket zum Einbinden von Graphiken und Bildern
\usepackage{graphicx}

% Paket zur Verwendung nummerierter Auflistungen
\usepackage{enumerate}


% Paket zum unmittelbaren Erzwingen von Abbildungspositionen
\usepackage{here}

% Paket zur Verwendung einer verbesserten Schriftart
\usepackage{lmodern}

% Paket zur besseren Implementierung von Code in den Fließtext
\usepackage{fancyvrb}

% Paket zur Verlinkung der Labels und des Inhaltsverzeichnisses
\usepackage[plainpages=false]{hyperref}


% Paket zum Verwenden gewisser mathematischer Symbole
\usepackage{mathtools}
\usepackage{stmaryrd} %ZB \rrbracket \llbracket

\usepackage{listings}
\usepackage{xcolor}

\usepackage{graphicx}

% Paket zur Verwendung nummerierter Auflistungen
\usepackage{enumerate}

% Paket zur Verwendung einer verbesserten Schriftart
\usepackage{lmodern}

% for matrices to fit the page
\newcommand\scalemath[2]{\scalebox{#1}{\mbox{\ensuremath{\displaystyle #2}}}}

\usepackage{siunitx}

% Umgebung fuer die Aufgabenbeschreibung
\newtheorem {Aufgabe}{Aufgabe}

% Formatierung der Seiten
\oddsidemargin=0.in
\topmargin=-1.5cm
\textheight=23cm
\textwidth=16cm


% Einrücken von neuen Zeilen ausschalten
\setlength{\parindent}{0cm}


\begin{document}

%-------------------------------------------------------------------------------------------
% Deckblatt
%-------------------------------------------------------------------------------------------

% Umnummerierung des Decksblatts zum fehlerfreien Gebrauch des hyperref- Pakets
\pagenumbering{Alph}

% Setzen von Titel, Autor und Datum auf dem Deckblatt
\title{{\Huge The Chipmunk Adventure} \\[18pt]
Wissenschaftliches Rechnen II \\[18pt]}
\author{ \textbf{Teamname} \\
Jan Breuer\\
Mats Lerho \\
Henrik Zunker}
\date{\today}

% Erzeugung des Deckblattes
\maketitle

% Weitere Angaben (Arbeitsgruppe, Institut, Universität, Betreuung usw.)
%\begin{center} 
%\begin{Large}
%Mathematisches Institut \\[3pt]
%Mathematisch-Naturwissenschaftliche Fakultät \\[3pt]
%Universität zu Köln \\[3cm]
%Betreuung: Prof. Dr.-Ing. Gregor Gassner
%\end{Large}
%\end{center}


\thispagestyle{empty} % Unterdrücken der Seitennummerierung


%-------------------------------------------------------------------------------------------
% 
%-------------------------------------------------------------------------------------------

\newpage
\tableofcontents
\thispagestyle{empty}
\newpage

% Umstellung der Seitennummerierung auf arabische Ziffern
\pagenumbering{arabic}
\section{Meilenstein 1}
To have a good foundation for the subsequent milestones, we focus on the Euler equations which have the vector of conservative variables $u=(\rho, \rho v1, \rho v2, E)^T$. In particular, we concentrate on the implementation of the standard strongform DGSEM in $2$D for a Cartesian (not necessarily square shaped) block.
\subsection{Divergenzform}

1. Formulate the compressible Euler equations in divergence form 
\begin{align*}
	u_t+f(u)_x + g(u)_y =0 
\end{align*}
and explicitly state the fluxes f, g.
\\
\\
\textbf{Lösung:}

Die kompressiblen Euler Gleichungen sind gegeben durch:
\begin{align*}
	\varrho_t+ \nabla \  \circ \ (\varrho v)&=0\\
	(\varrho v)_t+ \nabla \  \circ \ (\varrho vv^T + pI)&=0\\
	E_t + \nabla \ \circ \ [(E+p)v]&=0
\end{align*}
Da $v=(v_1,v_2)^T$ gilt, sind die Gleichungen äquivalent zu
\begin{align*}
	\varrho_t+ (\varrho v_1)_x + (\varrho v_1)_y  &=0\\
	(\varrho v_1)_t+ (\varrho v_1^2 + p)_x + (\varrho v_1 v_2)_y &=0\\
	(\varrho v_2)_t+ (\varrho v_1 v_2 )_x + (\varrho v_2^2 + p)_y &=0\\
	E_t + [(E+p)v_1]_x + [(E+p)v_2]_y&=0
\end{align*}
Damit lässt sich die Divergenzform aufstellen:
\begin{align*}
	\left(\begin{array}{c} \varrho \\ \varrho v_1 \\ \varrho v_2 \\ E \end{array}\right)_t	+  \left(\begin{array}{c} \varrho v_1 \\ \varrho v_1^2 + p \\ \varrho v_1 v_2 \\ (E+p)v_1 \end{array}\right)_x +  \left(\begin{array}{c} \varrho v_2 \\ \varrho v_1 v_2 \\ \varrho v_2^2+p \\ (E+p)v_2 \end{array}\right)_y = 0
\end{align*}

\qed
\newline
\noindent 
\subsection{quasilineare Form}

2. Write the equations in their quasi-linear form
\begin{align*}
	u_t+Au_x + Bu_y =0 
\end{align*}
and find the eigenvalues of flux Jacobian matrices A, B. Explain why
the maximum eigenvalue is important in the explicit time integration.
\\
\\
\textbf{Lösung:}
Sei $u=(u_1,u_2,u_3,u_4)^T=(\varrho , \varrho v_1, \varrho v_2, E)^T$. \\
Dann gilt 
\begin{align*}
	p&=(\gamma -1)(E+\frac{\varrho}{2} ||v||^2)
	=(\gamma -1)(E+\frac{\varrho}{2} (v_1^2+v_2^2))
	=(\gamma -1)(u_4+ \frac{u_2^2}{2 u_1}+\frac{u_3^2}{2 u_1} )
\end{align*}
und 
\begin{align*}
	f=\left(\begin{array}{c} \varrho v_1 \\ \varrho v_1^2 + p \\ \varrho v_1 v_2 \\ (E+p)v_1 \end{array}\right)= \left(\begin{array}{c} u_2 \\ \frac{u_2^2}{u_1} + p \\ \frac{u_2 u_3}{u_1} \\ \frac{u_2}{u_1} (u_4+p) \end{array}\right)\\
	g=\left(\begin{array}{c} \varrho v_2 \\ \varrho v_1 v_2 \\ \varrho v_2^2+p \\ (E+p)v_2 \end{array}\right)=
	\left(\begin{array}{c} u_3 \\ \frac{u_2 u_3}{u_1} \\ \frac{u_3^2}{u_1} + p \\ \frac{u_3}{u_1} (u_4+p) \end{array}\right)
\end{align*}

Insgesamt ergeben sich die Matrizen $A=\frac{\partial f}{\partial u}$ und $B=\frac{\partial g}{\partial u}$

\begin{align*}
	A=
	\scalemath{0.8}{
		\begin{pmatrix}
			0 & 1 & 0 & 0\\
			-(\frac{u_2}{u_1})^2- (\gamma -1) \left[\frac{u_2^2}{2 u_1^2}+\frac{u_3^2}{2 u_1^2}\right]    & \frac{2 u_2}{u_1} - (\gamma - 1)\frac{u_2}{u_1} &  (\gamma - 1) \frac{u_3}{u_1} & (\gamma - 1) \\
			-\frac{u_2 u_3}{u_1^2} & \frac{u_3}{u_1} & \frac{u_2}{u_1} & 0 \\
			-\frac{u_2 u_4}{u_1^2}-\frac{u_2}{u_1^2}(\gamma -1) \left(u_4+\frac{u_2^2+u_3^2}{2u_1}\right) - \frac{u_2}{u_1}(\gamma - 1) \frac{u_2^2+u_3^2}{2u_1^2} & 
			\frac{u_4}{u_1}+\frac{1}{u_1}(\gamma - 1) (u_4+ \frac{u_2^2+ u_3^2}{2 u_1}) + (\gamma - 1) (\frac{u_2}{u_1})^2
			& (\gamma - 1) \frac{u_2 u_3}{u_1^2} & \frac{u_2}{u_1} - (\gamma - 1) \frac{u_2}{u_1} 
	\end{pmatrix} }
\end{align*}

\begin{align*}
	B =
	\scalemath{0.8}{
		\begin{pmatrix}
			0 & 0 & 1 & 0\\
			-\frac{u_2 u_3}{u_1^2}  & \frac{u_3}{u_1} &   \frac{u_2}{u_1} & 0\\
			-(\frac{u_3}{u_1})^2- (\gamma -1) \left[\frac{u_2^2}{2 u_1^2}+\frac{u_3^2}{2 u_1^2}\right]  & (\gamma - 1 ) \frac{u_2}{u_1}& \frac{2 u_3}{u_1} + (\gamma - 1)\frac{u_3}{u_1} & ( \gamma - 1) \\
			-\frac{u_3  u_4}{u_1^2}-\frac{u_3}{u_1^2}(\gamma -1) \left(u_4+\frac{u_2^2+u_3^2}{2u_1}\right) - \frac{u_3}{u_1}(\gamma - 1) \frac{u_2^2+u_3^2}{2u_1^2} &  (\gamma - 1) \frac{u_2 u_3}{u_1^2}
			& \frac{u_4}{u_1}+\frac{1}{u_1}(\gamma - 1) (u_4+ \frac{u_2^2+ u_3^2}{2 u_1}) + (\gamma - 1) (\frac{u_3}{u_1})^2  & \frac{u_3}{u_1} - (\gamma - 1) \frac{u_3}{u_1} 
	\end{pmatrix} }
\end{align*}

Die Schallgeschwindigkeit ist gegeben durch $c=\sqrt{\frac{\gamma p}{\varrho}}$
Die Eigenwerte von A sind gegeben durch:
\begin{align*}
	\lambda_1=v_1 - c ,\lambda_2 = \lambda_3 = v_1 , \lambda_4 = v_1 + c
\end{align*}

Und die von B durch:
\begin{align*}
	\lambda_1=v_2- c ,\lambda_2 = \lambda_3 = v_2 , \lambda_4 = v_2 + c
\end{align*}

\qed

TODO: Noch einfügen, warum max EV wichtig für Zeitint. Gute Begründung aus alten Projekten nehmen!

Um ein stabiles Verfahren zu erhalten, ist die Relation $\Delta t \sim \Delta x $ gemäß der CFL-Bedingung notwendig. Dabei wird die Systemgeschwindigkeit über den maximalen Eigenwert der System Matrizen, hier $A$ und $B$, abgeschätzt. 

\subsection{Standard DGSEM Verification}
3. Implement the standard strong form of the DGSEM for the compress-ible Euler equations on two-dimensional Cartesian meshes as you al-ready did in the previous course "Wissenschaftliches Rechnen I". Youcan also re-use the five stage, fourth order Runge-Kutta method aswell as the simple local Lax-Friedrichs Riemann solver. For now, the boundary conditions can be assumed to be periodic. \\
4. Verify the high-order convergence rate of the Standard DG version, as you did in the previous semester, for the two polynomial degrees N=3 and N=4. \\
\newline
\textbf{Lösung:} \\
Die Konvergenz des Verfahrens testen wir mit einer $2$-periodischen Sinusfunktion als Anfangsbedingung auf einem periodischen Gebiet $[0, 2]^2$ und von $t=0$ bis $t=2$.
\begin{align}
u_0(x_1, x_2, t) = 
\begin{pmatrix}
2 + 0.1 \cdot sin( \pi (x_1 + x_2 - t)) \\
2 + 0.1 \cdot sin( \pi (x_1 + x_2 - t)) \\
2 + 0.1 \cdot sin( \pi (x_1 + x_2 - t)) \\
2 + 0.1 \cdot sin( \pi (x_1 + x_2 - t))
\end{pmatrix}
\label{Anfangsbedingung Konvergenz}
\end{align}

Konvergenztabellen für das standard DGSEM.

\begin{table}[H]
\parbox{.45\linewidth}{
\centering
    \begin{tabular}{|r|r|r|}
    \hline\hline
    \textbf{Nq} & \textbf{Error} & \textbf{EOC} \\\hline
    2 & $\num{6.42854e-02}$ & $\num{}$ \\
    4 & $\num{1.32856e-02}$ & $\num{2.27}$ \\
    8 & $\num{8.78254e-04}$ & $\num{3.92}$ \\
    16 & $\num{4.49618e-05}$ & $\num{4.29}$ \\
    32 & $\num{2.92247e-06}$ & $\num{3.94}$ \\
    64 & $\num{1.91309e-07}$ & $\num{3.93}$ \\\hline\hline
  \end{tabular} 
  \caption{N = $3$}
  }
  \parbox{.45\linewidth}{
	\centering
    \begin{tabular}{|r|r|r|}
    \hline\hline
    \textbf{Nq} & \textbf{Error} & \textbf{EOC} \\\hline
    2 & $\num{2.38883e-02}$ & $\num{}$ \\
    4 & $\num{1.14360e-03}$ & $\num{4.38}$ \\
    8 & $\num{4.22035e-05}$ & $\num{4.76}$ \\
    16 & $\num{2.07943e-06}$ & $\num{4.34}$ \\
    32 & $\num{8.93401e-08}$ & $\num{4.54}$ \\
    64 & $\num{3.37353e-09}$ & $\num{4.73}$ \\\hline\hline
  \end{tabular}
   \caption{N = $4$}
  }
\end{table}

\newpage
\section{Meilenstein 2}
As we know, a scheme has to satisfy a certain amount of requirements toguarantee convergence to a physical correct and unique solution. In the lastsemester, we have constructed so-called entropy stable discretisations, whichmeans that the discrete mathematical entropy is a non-increasing quantity.These entropy stable discretisations satisfy the fundamental second law ofthermodynamics, which brings us closer to our goal to construct a physicalcorrect solution. As we have seen in the previous course, numerical experi-ments clearly demonstrate an improved robustness of the discretisation.For this portion of the project, we focus on the implementation of theDGSEM for the split form of the equations.
\subsection{Chandrashekar split form}
\textbf{1.} Replace the divergence form of the volume integral with the Chandrashekar split form (eq.  (3.20) in [1]) by exchanging the volumenumerical fluxes $F^\#$,$G^\#$. This way the Riemann solver also changes, though the data transfer does not. For the standard DGSEM the local Lax-Friedrichs method in the $x$-direction is 
\begin{align}
F^{\star} =\frac{1}{2}- \lambda_{max} \ 2 \ \llbracket \underline{u} \rrbracket
\end{align}
whereas for the split form approximations the Riemann solver is coupled to the split form
\begin{align}
\label{riemannsplit}
 F^{\star} = F^\#_{\text{Chandrashekar}} - \lambda_{max} \ 2 \ \llbracket \underline{u} \rrbracket
\end{align}
\textbf{2.} Verify the high order convergence rate as well as the entropy-conservation and entropy-stabilisation properties of the split form scheme. \\
\newline
\textbf{Lösung:} \\
Die Konvergenz des Verfahrens testen wir erneut mit der $2$-periodischen Sinusfunktion aus Gleichung \ref{Anfangsbedingung Konvergenz} als Anfangsbedingung auf einem periodischen Gebiet $[0, 2]^2$ und von $t=0$ bis $t=2$.\\

Konvergenztabellen für das Split-Form DGSEM mit Chandrashekar Fluss.

\begin{table}[H]
\parbox{.45\linewidth}{
\centering
    \begin{tabular}{|r|r|r|}
    \hline\hline
    \textbf{Nq} & \textbf{Error} & \textbf{EOC} \\\hline
    2 & $\num{6.87889e-02}$ & $\num{}$ \\
    4 & $\num{1.42021e-02}$ & $\num{2.28}$ \\
    8 & $\num{8.05405e-04}$ & $\num{4.14}$ \\
    16 & $\num{3.93625e-05}$ & $\num{4.35}$ \\
    32 & $\num{2.49788e-06}$ & $\num{3.98}$ \\
    64 & $\num{1.91309e-07}$ & $\num{3.93}$ \\\hline\hline
  \end{tabular} 
  \caption{N = $3$}
  }
  \parbox{.45\linewidth}{
	\centering
    \begin{tabular}{|r|r|r|}
    \hline\hline
    \textbf{Nq} & \textbf{Error} & \textbf{EOC} \\\hline
    2 & $\num{2.29650e-02}$ & $\num{}$ \\
    4 & $\num{8.08062e-04}$ & $\num{4.83}$ \\
    8 & $\num{3.71735e-05}$ & $\num{4.44}$ \\
    16 & $\num{1.76278e-06}$ & $\num{4.40}$ \\
    32 & $\num{7.82467e-08}$ & $\num{4.49}$ \\
    64 & $\num{2.91605e-09}$ & $\num{4.75}$ \\\hline\hline
  \end{tabular}
   \caption{N = $4$}
  }
\end{table}
Zur Entropie Konservierung und Entropie Stabilität/Dissipativität: \\
Die Chandrashekar Split-Form DGSEM ist Entropie stabil/dissipativ und nicht Entropie erhaltend. 
Zum Test dieser Eigenschaft wurde die Anfangsbedingung einer schwachen Druckwelle gewählt und die Veränderung der Entropie von $t=0$ bis $t=2$ auf einem Gebiet mit periodischen Randbedingungen betrachtet.\\
Änderung der Entropie mit Chandrashekar split Form DGSEM und Lax-Friedrichs Oberflächenfluss, $Nq = 16$: 
\begin{table}[H]
\centering
\begin{tabular}{|r|r|r|}
    \hline\hline
     & \textbf{N=4} & \textbf{N=3} \\\hline
    \textbf{$t=0$} & $\num{-5.71025015e-05}$ & $\num{-5.92064714e-05}$ \\
    \textbf{$t=2$} &  $\num{-3.21918983e-04}$ & $\num{-3.56391403e-04}$ \\
    \textbf{change} & $\num{-6.39293138e-05}$ & $\num{-7.03772643e-05}$ \\\hline\hline
\end{tabular}
\end{table}
Das Verfahren ist also Entropie dissipativ mit dem dissipativen Oberflächen Fluss. (Andres hatte hier empfohlen, auch mal den zentralen fluss zu verwenden um zu prüfen ob die DIssipation daher kommt, der zentrale ist nämlich nicht dissipativ. allerdings schmiert das programm mit diesem oberflächenfluss ab.. deswegen testen wir die eoc initial bedningung statt der Druckwelle um Konservativität mit dem zentralen FLuss zu zeigen) \\
Änderung der Entropie mit Chandrashekar split Form DGSEM und Zentralem Oberflächenfluss, $Nq = 16$: 
\begin{table}[H]
\centering
\begin{tabular}{|r|r|r|}
    \hline\hline
     & \textbf{N=4} & \textbf{N=3} \\\hline
    \textbf{$t=0$} & $\num{5.96901414e+00}$ & $\num{5.96901414e+00}$ \\
    \textbf{$t=2$} &  $\num{5.96901409e+00}$ & $\num{5.96901401e+00}$ \\
    \textbf{change} & $\num{2.29319463e-11}$ & $\num{1.12220590e-09}$ \\\hline\hline
\end{tabular}
\end{table}

\textbf{3.} What can you tell about the stability of the standard DGSEM for the Euler equations in comparison to the split form scheme we are discussing here? \\
Derselbe Test im selben setting aber mit standard DGSEM und Lax-Friedrichs:
\begin{table}[H]
\centering
\begin{tabular}{|r|r|r|}
    \hline\hline
     & \textbf{N=4} & \textbf{N=3} \\\hline
    \textbf{$t=0$} & $\num{-5.71025015e-05}$ & $\num{-5.92064714e-05}$ \\
    \textbf{$t=2$} &  $\num{-3.28236824e-04}$ & $\num{-3.64796886e-04}$ \\
    \textbf{change} & $\num{-6.28522402e-05}$ & $\num{-6.83109410e-05}$ \\\hline\hline
\end{tabular}
\end{table}
standard DGSEM und Zentraler FLuss
\begin{table}[H]
\centering
\begin{tabular}{|r|r|r|}
    \hline\hline
     & \textbf{N=4} & \textbf{N=3} \\\hline
    \textbf{$t=0$} & $\num{5.96901414e+00}$ & $\num{5.96901414e+00}$ \\
    \textbf{$t=2$} &  $\num{5.96901408e+00}$ & $\num{5.96901358e+00}$ \\
    \textbf{change} & $\num{-5.41344278e-08}$ & $\num{-1.19035038e-06}$ \\\hline\hline
\end{tabular}
\end{table}
Abhängig vom Oberflächenfluss ist die Chandrashekar Split Form Entropie erhaltend, wohingegen das standard DGSEM immer Entropie dissipativ ist.\\

\textbf{4.} Explain what freestream preservation means and why it might be im-portant for this project. \\
Freistromerhaltung bedeutet, dass ein numerisches Verfahren eine konstante Lösung erhält und keine künstlichen Artefakte bildet, welche sich hochschaukeln können im Laufe der Rechnung. In diesem Projekt ist die Freistromerhaltung wichtig, da dies grundsätzlich eine wichtige Eigenschaft guter Verfahren ist. Außerdem spielt hier die Freistromerhaltung insbesondere für die Approximation der Geometrie in einem krummlinigen Gitter eine Rolle: Die Freistromerhaltung ist dann gewährleistet, wenn die Randkurven mit Polynomen vom selben Polynomgrad approximiert werden wie die für das DGSEM gewählte LGL Basis. (Vgl Skript WR$1$) 

\newpage
\section{Meilenstein 3}
We now want to approximate the solution of the Euler equations on curvi-linear geometries, which is especially important when our simulation domainhas curved boundaries. In the last semester, we learned how to constructcurvilinear mappings. For this part of the project, we will use curvilinear mappings to extend our standard and split-form DGSEM code to curvilinearstructured meshes. The first step is to make our code able to approximate the solution of the Euler equations on a curvilinear block with periodic boundary conditions. The curvilinear block will be obtained from a Cartesian block, $ \eta, \xi \in [-1, 1]^2$, using the following mapping:
\begin{align*}
x = \eta + 0.15 cos\left(\frac{\pi}{2}\eta \right)cos\left(\frac{3}{2}\pi \xi \right) \\
y = \xi + 0.15 cos\left(2\pi \eta \right) cos\left(\frac{\pi}{2}\xi \right)
\end{align*}

\subsection{Curved mesh, transfinite mapping and contravariant fluxes}
\textbf{1.} Generate the mesh: Implement routines to obtain the physical coordinates of the LGL nodes for all elements of the mesh.\\
\textbf{2.} Construct transfinite mappings to transform the coordinates of a reference element, $ \xi, \eta \in [-1, 1]^2$, to the physical coordinates of each element: $x(\xi,\eta)$. The input of the transfinite mapping routines should be the physical coordinates of the LGL nodes of each element.\\
\textbf{3.} Rewrite the conservation law in terms of the contravariant fluxes,
\begin{align*}
  J u_t + \tilde{f}_\xi +\tilde{g}_\eta =0
\end{align*}
and explicitly state the contravariant fluxes in terms of the quantities known from the transfinite mapping. See last semester’s script and [3]. \\
\textbf{Solution:}
The conservation law states 
\begin{align}
 u_t + f_x +g_y &= 0 \\
 \Rightarrow  u_t + \frac{\partial f}{\partial\xi} \frac{\partial\xi}{\partial x}+\frac{\partial f}{\partial \eta} \frac{\partial \eta}{\partial y} + \frac{\partial g}{\partial\xi} \frac{\partial\xi}{\partial x}+\frac{\partial g}{\partial\eta} \frac{\partial\eta}{\partial y} &= 0
\label{contravariant1}
\end{align}
Instead of estimating an inverse mapping, we use the Chain rule to obtain the metric terms $\eta_x, \eta_y, \xi_x, \xi_y$:\\
Comparing
\begin{align*}
\begin{pmatrix}
\frac{\partial u}{\partial x} \\
\frac{\partial u}{\partial y}
\end{pmatrix} =
\begin{pmatrix}
\frac{\partial \xi}{\partial x} & \frac{\partial \eta}{\partial x}\\
\frac{\partial \xi}{\partial y} & \frac{\partial \eta}{\partial y}
\end{pmatrix} \cdot
\begin{pmatrix}
\frac{\partial u}{\partial \xi} \\
\frac{\partial u}{\partial \eta}
\end{pmatrix}
\end{align*}
and 
\begin{align*}
\begin{pmatrix}
\frac{\partial u}{\partial \xi} \\
\frac{\partial u}{\partial \eta}
\end{pmatrix} =
\begin{pmatrix}
\frac{\partial x}{\partial \xi} & \frac{\partial y}{\partial \xi}\\
\frac{\partial x}{\partial \eta} & \frac{\partial y}{\partial \eta}
\end{pmatrix} \cdot
\begin{pmatrix}
\frac{\partial u}{\partial x} \\
\frac{\partial u}{\partial y}
\end{pmatrix}
\end{align*}
it follows with the $2D$ Matrix Inverse that
\begin{align*}
\begin{pmatrix}
\frac{\partial \xi}{\partial x} & \frac{\partial \eta}{\partial x}\\
\frac{\partial \xi}{\partial y} & \frac{\partial \eta}{\partial x}
\end{pmatrix} =
\begin{pmatrix}
\frac{\partial x}{\partial \xi} & \frac{\partial y}{\partial \xi}\\
\frac{\partial x}{\partial \eta} & \frac{\partial y}{\partial \eta}
\end{pmatrix}^{-1} =
\frac{1}{J}
\begin{pmatrix}
\frac{\partial y}{\partial \xi} & -\frac{\partial y}{\partial \eta}\\
-\frac{\partial x}{\partial \xi} & \frac{\partial x}{\partial \eta}
\end{pmatrix}
\end{align*}
with $J= x_\xi y_\eta - x_\eta y_\xi $.

We then use the derivations of the mapping:
\begin{align}
\nabla x(\xi, \eta) &= 
\begin{pmatrix}
x_\xi & x_\eta\\
y_\xi & y_\eta
\end{pmatrix} \nonumber \\ &=
\begin{pmatrix}
1 - 0.15 \frac{\pi}{2} sin(\frac{\pi}{2}\xi) cos(\frac{3\pi}{2} \eta) &
- 0.15 cos(\frac{\pi}{2}\xi) \frac{3\pi}{2} sin(\frac{3\pi}{2} \eta) \\
- 0.15 \cdot 2\pi sin(2\pi\xi) cos(\frac{\pi}{2} \eta) &
1 - 0.15 cos(2\pi \xi) \frac{\pi}{2}  sin(\frac{\pi}{2} \eta)
\end{pmatrix}
\label{metricterms}
\end{align}
We can now state equation \ref{contravariant1} in terms of the contravariant fluxes:
\begin{align}
 J u_t + ,\tilde{f_\xi} + \tilde{g_\eta} = 0
 \label{contravariantequation}
\end{align}
with $\tilde{f} := f(y_\eta) + g(-x_\eta)$ and $\tilde{g} =: f(-y_\xi) + g(x_\xi)$.
%Note that equation \ref{contravariantequation} only holds for smooth solutions where we can exchange derivations such that 
%\begin{align*}
%23
%\end{align*}
%holds. (VGL WS1 S.71 EQ190)
\\Since we know the metric terms from equation \ref{metricterms}, we can explicitly state the transformed fluxes. \\ \ \\
\textbf{4.} Modify the volume and surface integral routines of the standard and split-form DGSEM code. Take into account that the volume numericalfluxes of the split-form DGSEM need metric dealiasing.\\

We modified the volume integral routine by using a pseudo-strong form that includes a part of the surface integral of the strong form DGSEM. We get $[Df - Sf]$ as the (pseudo) volume integral. The only modification of the surface integral was the inclusion of the metric terms for the Riemann solver of the split form approximation from equation \ref{riemannsplit}. \\
Following \cite{Gassner_2016} ($B.9$) we included the metric terms for the two point volume flux by simply using the arithmetic mean of the contravariant vectors at the corresponding nodes:
\begin{align*}
(D \cdot f)_{ij} = 2 \sum D_{im} \left[ F^{\#}(U_{ij}, U_{mj}) \cdot \left\{\left\{ Ja^1_1 \right\}\right\}_{(i,j)m} + G^{\#}(U_{ij}, U_{mj}) \cdot \left\{\left\{ Ja^1_2 \right\}\right\}_{(i,j)m} \right] \\
(g \cdot D^T)_{ij} = 2 \sum D_{jm} \left[ F^{\#}(U_{ij}, U_{im}) \cdot \left\{\left\{ Ja^2_1 \right\}\right\}_{i(m,j)} + G^{\#}(U_{ij}, U_{im}) \cdot \left\{\left\{ Ja^2_2 \right\}\right\}_{i(m,j)} \right]
\end{align*}

\textbf{5.} Test free-stream preservation, entropy conservation, entropy stability and EOCs in this distorted mesh.
We test the free-stream preservation on the given mesh and with the following constant initial condition from $t=0$ to $t=2$.
\begin{align*}
\rho = 1.0 \\
  \rho v_1 = 0.1 \\
  \rho v_2 = -0.2 \\
  rho e = 10.0
\end{align*}
The estimated ($L_{inf}, L_2$) error in each dimension \\
$3.67483821e-14, \hspace{1cm} 5.30300443e-15 \\  1.47035162e-13, \hspace{1cm} 1.84694396e-14\\  2.59042787e-13, \hspace{1cm} 3.23687394e-14 \\ 1.88293825e-13, \hspace{1cm} 1.35445279e-14$ \\

lies within the mechanical tolerance.\\
Convergency tables for the Split-Form DGSEM with Chandrashekar flux on a curved mesh.

\begin{table}[H]
\parbox{.45\linewidth}{
\centering
    \begin{tabular}{|r|r|r|}
    \hline\hline
    \textbf{Nq} & \textbf{Error} & \textbf{EOC} \\\hline
    2 & $\num{4.79568e-01}$ & $\num{}$ \\
    4 & $\num{1.33437e-01}$ & $\num{1.85}$ \\
    8 & $\num{1.41487e-02}$ & $\num{3.24}$ \\
    16 & $\num{1.42711e-03}$ & $\num{3.31}$ \\
    32 & $\num{1.29616e-04}$ & $\num{3.46}$ \\\hline\hline
  \end{tabular} 
  %64 │ 1.25827e-05 │ 3.36
  \caption{N = $3$}
  }
  \parbox{.45\linewidth}{
	\centering
    \begin{tabular}{|r|r|r|}
    \hline\hline
    \textbf{Nq} & \textbf{Error} & \textbf{EOC} \\\hline
    2 & $\num{2.83922e-01}$ & $\num{}$ \\
    4 & $\num{3.28587e-02}$ & $\num{3.11}$ \\
    8 & $\num{2.28311e-03}$ & $\num{3.85}$ \\
    16 & $\num{1.87609e-04}$ & $\num{3.61}$ \\
    32 & $\num{1.18732e-05}$ & $\num{3.98}$ \\\hline\hline
  \end{tabular}
   \caption{N = $4$}
  }
\end{table}
Die Ordnung sinkt auf einem krummlinigen Gitter, auch das standard DGSEM verliert Ordnungsstufen. (noch mit tabelle vergleichen?) \\
Entropy dissipation with $Nq = 16$, Chandrashekar split form and Lax-Friedrichs surface flux: \\
\begin{table}[H]
\centering
\begin{tabular}{|r|r|r|}
    \hline\hline
     & \textbf{N=4} & \textbf{N=3} \\\hline
    \textbf{$t=0$} & $\num{-2.35388759e-04}$ & $\num{-2.31586708e-04}$ \\
    \textbf{$t=2$} &  $\num{-1.41339324e-03}$ & $\num{-1.38273429e-03}$ \\
    \textbf{change} & $\num{-3.97685382e-04}$ & $\num{-3.37568102e-04}$ \\\hline\hline
\end{tabular}
\end{table}
Test wieder mit der schwachen Schockwelle. Da wir periodische RB haben passt das iwie alles lul.\\
Da die Entropie Konservativität mit zentralen oberflächenfluss für die Druckwelle abschmiert, testen wir die Bedingungen aus dem EOC test um Konservativität des Verfahrens (eben abhängig vom Oberflächenfluss) zu zeigen.\\
Entropy conservation with $Nq = 16$, Chandrashekar split form and Central surface flux: \\
\begin{table}[H]
\centering
\begin{tabular}{|r|r|r|}
    \hline\hline
     & \textbf{N=4} & \textbf{N=3} \\\hline
    \textbf{$t=0$} & $\num{5.96901414e+00}$ & $\num{5.96901414e+00}$ \\
    \textbf{$t=2$} &  $\num{5.96901414e+00}$ & $\num{5.96901414e+00}$ \\
    \textbf{change} & $\num{-7.74646326e-12}$ & $\num{6.85391566e-12}$ \\\hline\hline
\end{tabular}
\end{table}

\newpage
\addcontentsline{toc}{section}{Literaturverzeichnis}
\bibliography{Literaturverzeichnis}
\bibliographystyle{abbrv}



\end{document}



%  
%




















